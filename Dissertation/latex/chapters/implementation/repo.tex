\newpage
\section{Repository Overview}

\tikzstyle{dir}=[draw=black,thick,anchor=west]
\tikzstyle{src}=[draw=black,thick,anchor=west,fill=red!30]
\tikzstyle{file}=[draw=black,thick,anchor=west,draw=none]

\begin{wrapfigure}{r}{8cm}
\vspace{-15pt}
% \begin{figure}[tbh]
\begin{tikzpicture}[%
  grow via three points={one child at (0.5,-0.7) and
  two children at (0.5,-0.7) and (0.5,-1.4)},
  edge from parent path={(\tikzparentnode.south) |- (\tikzchildnode.west)}]
  \node [dir] {Excello}
    child { node [dir] {Excel Music}
      child { node [dir] {assets}}
      child { node [dir] {node\_modules}}
      child { node [dir] {src}
        child { node [file] {index.ts}}
        child { node [file] {turtle.ts}}
        child { node [file] {chords.ts}}
        child { node [file] {regex.ts}}
        child { node [file] {conversions.ts}}
        child { node [file] {bracketsParse.ts}}
      }
      child [missing] {}
      child [missing] {}
      child [missing] {}
      child [missing] {}
      child [missing] {}
      child [missing] {}
      child { node [file] {index.html}}
      child { node [file] {manifest.xml}}
    }
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child { node [dir] {CustomFunctions}
      child { node [dir] {src}
        child { node [file] {excello.ts}}
      }
      child [missing] {}
      child { node [dir] {config}
        child { node [file] {excello.json}}
      }
      child [missing] {}
      child { node [dir] {node\_modules}}
      child { node [file] {manifest.xml}}
    }
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child [missing] {}
    child { node [dir] {MIDI}
      child { node [file] {MIDI\_Conversion.ipynb}}
    };
\end{tikzpicture}
\caption{File structure overview showing original files}
\label{fig:repo}
\vspace{-30pt}
% \end{figure}
\end{wrapfigure}

\paragraph{} Figure \ref{fig:repo} shows a reduced project file structure including all original source code. Excel Music is the add-in that parses the notation and produces music. Both this and CustomFunctions were generated using the Yeoman generator. The manifest.xml files are added to Excel and point to the resources to run the add-in. Users were given a different manifest pointing to a distribution hosted online with Surge. node\_modules contains all libraries required to run the add-ins and is managed using npm.

\paragraph{} The index.html file defines the window that appears on the right of the spreadsheet. assets contains the piano samples. index.ts defines what happens when the buttons of the window are pressed and imports from the remaining Typescript files. turtle.ts contains all the code to produce musical output from the spreadsheet, with helper functions in regex.ts, conversions.ts and bracketsParse.ts. bracketsParse.ts was based on Parenthesis which was initially incompatible for Excello's needs. chords.ts is for inserting chord notes into the grid.

\paragraph{} customFunctions.ts contains the implementation of EXCELLO.TURTLE and EXCELLO.MODULATE. The index.html file created when generating this add-in is not seen by the user, so was not re-written.

\paragraph{} The Python notebook MIDI\_Conversion.ipynb converts MIDI files to the Excello notation. Conversions of MIDI corpora are included in the MIDI directory.

\paragraph{} I shall release Excello as an open source project under the MIT license. This is compatible with the MIT licenses of the libraries. The Salamander piano samples come under a creative commons license,\footnote{https://creativecommons.org/licenses/by/3.0/} so credit shall be given in the Excel add-in window.
